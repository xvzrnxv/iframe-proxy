<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GRIM SERVICES</title>
  <style>
    :root {
      --bg:#0f1221;--panel:#171a2e;--panel-2:#1f2342;
      --text:#e6e9ff;--muted:#a6abd6;--border:#2a2d59;
      --error:#ff4d4d;
    }
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;color:var(--text);
      background:var(--bg);display:flex;flex-direction:column;height:100vh;}
    header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;
      background:#11152b;border-bottom:1px solid var(--border);}
    header h1{font-size:20px;margin:0;cursor:pointer;font-weight:bold}
    #tabs{display:flex;gap:8px;align-items:center;margin-left:20px;}
    .tab{background:#1f2342;border:1px solid var(--border);padding:6px 10px;border-radius:6px;cursor:pointer;}
    .tab.active{background:#2a2f59;}
    .tab .close{margin-left:6px;color:#ff4d4d;cursor:pointer;}
    #profile{display:flex;gap:8px;align-items:center;}
    .btn{cursor:pointer;padding:6px 12px;border-radius:8px;font-weight:600;border:none}
    .btn.green{background:linear-gradient(180deg,#2bcf6d,#1a9f4e);color:#fff}

    .main-wrapper {flex: 1;display: flex;flex-direction: column;min-height: 0;}
    .main {flex: 1;display: grid;grid-template-columns: repeat(5, 1fr);gap: 16px;padding: 16px;min-height: 0;}
    .card {background: linear-gradient(180deg, var(--panel), var(--panel-2));border: 1px solid var(--border);
      border-radius: 16px;display: flex;flex-direction: column;min-height: 0;}
    .card h2 {margin: 0;padding: 12px;border-bottom: 1px solid var(--border);font-size: 16px;text-align: center;display: flex;align-items: center;justify-content: center;}
    .card .content {padding: 12px;flex: 1;overflow-y: auto;min-height: 0;}

    .list{display:grid;gap:8px;}
    .item{display:flex;align-items:center;justify-content:space-between;gap:8px;border:1px solid var(--border);background:#0b0d1a;padding:10px;border-radius:12px}
    .item strong{font-size:14px}
    .star{cursor:pointer;font-size:20px;}
    .star.filled{color:gold;}
    .fullscreen-iframe{width:100%;height:calc(100vh - 50px);border:none;}
    .normal-iframe{width:100%;height:500px;border:none;border-radius:12px;margin-top:12px;}
    .login-form{display:flex;flex-direction:column;gap:12px;max-width:400px;margin:40px auto;padding:20px;background:#1f2342;border-radius:12px}
    .login-form input{padding:10px;border-radius:8px;border:none}
    .popup{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:999;}
    .popup-box{background:var(--panel-2);padding:20px;border-radius:12px;display:flex;flex-direction:column;gap:12px;min-width:300px;text-align:center;}
    .popup-box button{margin:4px 0;}
  </style>
</head>
<body>
<header>
  <div style="display:flex;align-items:center;">
    <h1 onclick="setActiveTab('Home')">GRIM SERVICES</h1>
    <div id="tabs"></div>
  </div>
  <div id="profile"></div>
</header>

<div id="mainView" style="flex:1;min-height:0;"></div>
<div id="popupContainer"></div>

<script>
let favorites=[];

const PROXY = "https://iframe-proxy-cxaj.onrender.com/proxy?url=";

let games = [
  {
    name: "1v1.lol",
    img: "https://1v1lolunblocked.com/favicon.ico",
    url: PROXY + "https://1v1lolunblocked.com/games/1v1-lol/index.html"
  },
  {
    name: "Run 3",
    img: "https://lablockedgames.com/favicon.ico",
    url: PROXY + "https://lablockedgames.com/funblocked/run-3/index.html"
  }
];

let streams = [
  {
    name: "HDToday",
    img: "https://hdtodayz.to/favicon.ico",
    url: PROXY + "https://hdtodayz.to/"
  }
];

let music = [
  {
    name: "YouTube Music",
    img: "https://www.youtube.com/s/desktop/6b5ebaa4/img/favicon_144x144.png",
    url: "https://music.youtube.com"
  }
];

let socials = [
  {
    name: "Discord",
    img: "https://discord.com/assets/2c21aeda16de354ba5334551a883b481.png",
    url: "https://discord.com"
  }
];

let customLinks=[];
let tabs=[{name:"Home",url:"home"},{name:"Search",url:PROXY + "https://www.google.com"}];
let activeTab="Home";
let fullscreen=false;

function render(list,id){
  const el=document.getElementById(id);el.innerHTML="";
  list.forEach(g=>{
    let isFav=favorites.find(x=>x.name===g.name);
    const div=document.createElement("div");div.className="item";
    div.innerHTML=`
      <div class="row"><img src="${g.img}" style="width:40px;height:40px;border-radius:6px"><strong>${g.name}</strong></div>
      <div class="row">
        <button class="btn green" onclick="openInTab('${g.name}','${g.url}')">Play</button>
        <span class="star ${isFav?'filled':''}" onclick="toggleFavorite('${g.name}')">${isFav?'‚≠ê':'‚òÜ'}</span>
      </div>`;
    el.appendChild(div);
  });
}

function refresh(){
  if(activeTab==="Home"){
    document.getElementById("mainView").innerHTML=`
    <div style="display:flex;flex-direction:column;flex:1;min-height:0;">
      <div class="main">
        <section class="card"><h2>Games</h2><div class="content"><div class="list" id="gamesList"></div></div></section>
        <section class="card"><h2>Streaming</h2><div class="content"><div class="list" id="streamList"></div></div></section>
        <section class="card"><h2>Music</h2><div class="content"><div class="list" id="musicList"></div></div></section>
        <section class="card"><h2>Social Media</h2><div class="content"><div class="list" id="socialList"></div></div></section>
        <section class="card"><h2>Custom Links</h2><div class="content">
          <input type="file" id="customLinkIcon" accept="image/*"><br>
          <input type="text" id="customLinkName" placeholder="Name"><br>
          <input type="text" id="customLinkUrl" placeholder="Link"><br>
          <button class="btn green" onclick="addCustomLink()">Confirm</button>
          <div class="list" id="customList"></div>
        </div></section>
      </div>
      <section class="card" style="margin:8px;height:auto;flex:0;">
        <h2>Site Settings</h2>
        <div class="content" style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
          <input id="tabTitleInput" type="text" placeholder="Tab Title">
          <input id="tabIconInput" type="file" accept="image/*">
          <button class="btn" onclick="openBlank()">Open Blank</button>
          <button class="btn" style="background:var(--error)" onclick="deleteData()">Delete Data</button>
        </div>
      </section>
    </div>`;
    render(games,"gamesList");
    render(streams,"streamList");
    render(music,"musicList");
    render(socials,"socialList");
    render(customLinks,"customList");
  } else if(activeTab==="Favorites"){
    document.getElementById("mainView").innerHTML=`
      <section class="card" style="margin:16px;flex:1;">
        <h2>Favorite Games</h2>
        <div class="content"><div class="list" id="favGamesList"></div></div>
      </section>`;
    render(favorites,"favGamesList");
  } else {
    let t=tabs.find(x=>x.name===activeTab);
    if(t){
      document.getElementById("mainView").innerHTML=`
        <iframe id="siteFrame" class="${fullscreen?'fullscreen-iframe':'normal-iframe'}" src="${t.url}"></iframe>`;
    }
  }
  renderTabs();
  renderProfileButtons();
}

function renderTabs(){
  let tabDiv=document.getElementById("tabs");tabDiv.innerHTML="";
  tabs.forEach(t=>{
    const div=document.createElement("div");div.className="tab"+(t.name===activeTab?" active":"");
    div.innerHTML=t.name+(t.name!=="Home" && t.name!=="Search"?`<span class="close" onclick="closeTab('${t.name}')">x</span>`:"");
    div.onclick=()=>setActiveTab(t.name);
    tabDiv.appendChild(div);
  });
}

function renderProfileButtons(){
  let p=document.getElementById("profile");p.innerHTML=`
    <button class="btn" onclick="openInTab('Favorites','favorites')">‚≠ê Favorites</button>
    <button class="btn green" onclick="saveData()">üíæ Save</button>
    <button class="btn" onclick="showProfilePopup()">üë§ Profile</button>`;
}

function showProfilePopup(){
  document.getElementById("popupContainer").innerHTML=`
    <div class="popup" onclick="closePopup(event)">
      <div class="popup-box">
        <h3>Profile</h3>
        <button class="btn green" onclick="openInTab('Login','login');closePopup()">Login</button>
        <button class="btn" onclick="openInTab('Signup','signup');closePopup()">Sign Up</button>
        <button class="btn" style="background:var(--error)" onclick="closePopup()">Cancel</button>
      </div>
    </div>`;
}
function closePopup(e){if(!e||e.target.classList.contains("popup"))document.getElementById("popupContainer").innerHTML="";}

function openInTab(name,url){
  let existing=tabs.find(t=>t.name===name);
  if(existing){setActiveTab(existing.name);return;}
  tabs.push({name,url});
  setActiveTab(name);
}
function setActiveTab(name){activeTab=name;refresh();}
function closeTab(name){tabs=tabs.filter(t=>t.name!==name);setActiveTab("Home");}

function toggleFullscreen(){fullscreen=!fullscreen;refresh();}
function toggleFavorite(name){
  let all=[...games,...streams,...music,...socials,...customLinks];
  let g=all.find(x=>x.name===name);if(!g)return;
  if(favorites.find(x=>x.name===name)){favorites=favorites.filter(x=>x.name!==name);}
  else{favorites.push(g);}
  refresh();
}
function addCustomLink(){
  let f=document.getElementById("customLinkIcon").files[0];
  let n=document.getElementById("customLinkName").value;
  let l=document.getElementById("customLinkUrl").value;
  if(!n||!l)return;
  let img=f?URL.createObjectURL(f):"https://via.placeholder.com/60";
  customLinks.push({name:n,img,url:l});refresh();
}
function openBlank(){openInTab("Blank","about:blank");}
function deleteData(){if(confirm("Delete all data?")){localStorage.clear();location.reload();}}
function saveData(){localStorage.setItem("grimData",JSON.stringify({games,streams,music,favorites,socials,customLinks}));alert("Saved!");}
window.onload=()=>{
  let d=localStorage.getItem("grimData");
  if(d){let o=JSON.parse(d);
    games=o.games||games;streams=o.streams||streams;music=o.music||music;favorites=o.favorites||[];
    socials=o.socials||socials;customLinks=o.customLinks||[];
  }
  refresh();
}
</script>
</body>
</html>
